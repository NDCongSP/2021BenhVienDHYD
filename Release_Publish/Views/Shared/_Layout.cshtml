<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewBag.Title - PT Web/Logger</title>
    <!-- add icon link -->
    <link rel="icon" href="~/Images/LogoIco.ico" type="image/x-icon" />
    @Scripts.Render("~/bundles/modernizr")
    <!-- Font Awesome -->
    <link rel="stylesheet" href="~/Assets/plugins/fontawesome-free/css/all.min.css">
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="~/Assets/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="~/Assets/dist/css/adminlte.min.css">
</head>

<body class="hold-transition sidebar-mini layout-fixed" style="padding: 0px;">
    <!-- Site wrapper -->
    <div class="wrapper">
        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-default navbar-dark fixed-top">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="~/Home/Index" style="color:white"><i class="fas fa-bars"></i></a>
                </li>
                @*<li class="nav-item d-sm-inline-block">
                        <a href="#">
                            <img src="~/Images/LogoPT.svg"
                                 alt="PhucThinh" width="120" height="80"
                                 style="opacity: 1">
                        </a>
                    </li>*@
                <li class="nav-item d-sm-inline-block">
                    <a class="nav-link text-bold" style="color:white" href="~/Home/Index">Logger Gateway</a>
                </li>
            </ul>
            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">
                <!-- Notifications Dropdown Menu -->
                <li class="nav-item dropdown">
                    <a class="nav-link" data-toggle="dropdown" href="#" style="color:white">
                        <i class="fas fa-1x mr-1 fa-cog"></i>
                        @*<span>Settings</span>*@
                    </a>
                    <div class="dropdown-menu dropdown-menu-md dropdown-menu-right">
                        @*<a href="#" class="dropdown-item" onclick="return showUpdatePassword()">
                                <i class="fas fa-lock mr-2"></i>
                                Change password
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" onclick="return showRestart()">
                                <i class="fas fa-redo mr-2"></i>
                                Reboot
                            </a>
                            <div class="dropdown-divider"></div>*@
                        <a href="~/Home/Logout" class="dropdown-item">
                            <i class="fas fa-sign-out-alt mr-2"></i>
                            Logout
                        </a>
                    </div>
                </li>
            </ul>
        </nav>

        <!-- /.navbar -->
        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-dark-dark elevation-4">
            <!-- Brand Logo -->
            <a href="~/Home/Index">
                <img src="~/Images/Logo.png"
                     alt="Phuc Thinh" width="120" height="120"
                     style="opacity: 1">
            </a>


            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar Menu -->
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column"
                        data-widget="treeview" role="menu" data-accordion="false">
                        <!-- Add icons to the links using the .nav-icon class
                        with font-awesome or any other icon font library -->
                        <li class="nav-item ">
                            <a href="~/Home/Index" class="nav-link">
                                <i class="nav-icon fas fa-home"></i>
                                <p>
                                    Home
                                </p>
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a href="~/Home/Alarm" class="nav-link">
                                <i class="nav-icon fas fa-bell"></i>
                                <p>
                                    Alarm
                                </p>
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a href="~/Home/Control" class="nav-link">
                                <i class="nav-icon fas fa-pencil-alt"></i>
                                <p>
                                    Control
                                </p>
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a href="~/Home/Trend" class="nav-link">
                                <i class="nav-icon fas fa-chart-line"></i>
                                <p>
                                    Trend
                                </p>
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a href="~/Home/Settings" class="nav-link">
                                <i class="nav-icon fas fa-cog"></i>
                                <p>
                                    Settings
                                </p>
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a href="~/Home/Report" class="nav-link">
                                <i class="nav-icon fas fa-print"></i>
                                <p>
                                    Report
                                </p>
                            </a>
                        </li>
                    </ul>
                </nav>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            @RenderBody()
        </div>

        <!-- /.content-wrapper -->
        <footer class="main-footer">
            <strong>Copyright &copy; 2020 <a href="http://phucthinhauto.com"> PHUC THINH CO.,LTD. All rights reserved.</a></strong>
        </footer>
        <!-- /.content-wrapper -->
        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Control sidebar content goes here -->
        </aside>
        <!-- /.control-sidebar -->
    </div>

    <div class="modal fade" id="modalChangePassword" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="modalChangePassword-label">Change Password</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="row">
                            <div class="form-group col">
                                <label for="modal-password">Old Password</label>
                                <input type="password" class="form-control" id="modal-password" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col">
                                <label for="modal-newpassword">New Password</label>
                                <input type="password" class="form-control" id="modal-newpassword" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col">
                                <label for="modal-comfirmpassword">Comfirm Password</label>
                                <input type="password" class="form-control" id="modal-comfirmpassword" />
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="btnUpdatePassword" style="display:none;" onclick="updatePassword();">Save</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalRestart" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="modalChangePassword-label">Restart</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="btnRestartModal" style="display:none;" onclick="updatePassword();">Restart</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <!-- ./wrapper -->
    <!-- jQuery -->
    <script src="~/Assets/plugins/jquery/jquery.min.js"></script>
    @*<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>*@

    <!-- Bootstrap 4 -->
    <script src="~/Assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- DataTables
    <script src="~/Assets/plugins/datatables/jquery.dataTables.js"></script>
    <script src="~/Assets/plugins/datatables-bs4/js/dataTables.bootstrap4.js"></script>
    -->
    <!-- overlayScrollbars -->
    <script src="~/Assets/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
    <!-- AdminLTE App -->
    <script src="~/Assets/dist/js/adminlte.min.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="~/Assets/dist/js/demo.js"></script>

    @RenderSection("scripts", required: false)

    <script type="text/javascript">
        function updatePassword() {
            var pass = $('#modal-password').val();
            if (pass == '' || pass == null) {
                toastr.error("Password can't be empty.");
                return;
            }
            var newPass = $('#modal-newpassword').val();
            if (newPass == '' || newPass == null) {
                toastr.error("New password can't be empty.");
                return;
            }
            else {
                var comfirmPass = $('#modal-comfirmpassword').val();

                if (comfirmPass != newPass) {
                    toastr.error("New password and comfirm do not match !");
                }
                else {
                    var obj = {
                        Password: pass,
                        NewPassword: newPass,
                    }

                    $.ajax({
                        url: "/Home/UpdatePassword",
                        data: JSON.stringify(obj),
                        type: "POST",
                        contentType: "application/json;charset=UTF-8",
                        dataType: "json",
                        success: function (result) {
                            if (result.Status == 'Ok') {
                                toastr.success('Change password successfully.');
                            }
                            else {
                                toastr.error('Change password failed.');
                            }
                        },
                        error: function (errormessage) {
                            toastr.error('Change password failed.');
                        }
                    });
                }
            }
        }

        function showUpdatePassword() {
            $('#modal-password').val('');
            $('#modal-newpassword').val('');
            $('#modal-comfirmpassword').val('');

            $('#modalChangePassword').modal('show');
            $('#btnUpdatePassword').show();
        }

        function showRestart() {

            $('#modalRestart').modal('show');
            $('#btnRestartModal').show();
        }

        function updatePassword() {
            //var txt = document.getElementById("txtWord").value;
            //alert(txt);
            $.ajax({
                url: "/Home/RestartDevices",
                data: JSON.stringify(obj),
                type: "POST",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                success: function (result) {
                    if (result.Status == 'Ok') {
                        toastr.success('Change password successfully.');
                    }
                    else {
                        toastr.error('Change password failed.');
                    }
                },
                error: function (errormessage) {
                    toastr.error('Change password failed.');
                }
            });
        }
    </script>

</body>
</html>
